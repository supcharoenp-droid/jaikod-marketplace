# üóëÔ∏è DATA CLEANUP GUIDE
## ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô

**Date:** 2025-12-28  
**Purpose:** ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢ Unified Listing System

---

## üéØ **‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**

‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠:
- ‚úÖ ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà **listings collection** ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
- ‚úÖ ‡πÉ‡∏ä‡πâ AI features ‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà
- ‚úÖ ‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏±‡∏Å‡∏©‡∏≤

---

## üìä **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô**

### Before Cleanup:
- ‚ùå ‡∏°‡∏µ **products** collection (legacy, ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏Å‡πà‡∏≤)
- ‚ùå ‡∏°‡∏µ **listings** collection (‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡∏°‡πà)
- ‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
- ‚ùå ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô

### After Cleanup:
- ‚úÖ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà **listings** collection
- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
- ‚úÖ AI features ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
- ‚úÖ UX ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠

---

## üîß **‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Cleanup Script**

### 1. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
```bash
npm run cleanup:count
```

**Output:**
```
üìä CURRENT DATA COUNT
==================================================

  Products:  9 documents
  Listings:  3 documents
  Users:     5 documents
```

---

### 2. ‡∏•‡∏ö Products Collection (Legacy)
```bash
npm run cleanup:products
```

**‡∏°‡∏±‡∏ô‡∏à‡∏∞:**
- ‚ùå ‡∏•‡∏ö‡∏ó‡∏∏‡∏Å document ‡πÉ‡∏ô `products` collection
- ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö `listings` ‡πÅ‡∏•‡∏∞ `users` ‡πÑ‡∏ß‡πâ

**Confirmation:**
```
‚ö†Ô∏è  Delete ALL documents in "products" collection? (yes/no):
```
‡∏û‡∏¥‡∏°‡∏û‡πå **yes** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

---

### 3. ‡∏•‡∏ö Listings Collection (‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)
```bash
npm run cleanup:listings
```

**‡∏°‡∏±‡∏ô‡∏à‡∏∞:**
- ‚ùå ‡∏•‡∏ö‡∏ó‡∏∏‡∏Å document ‡πÉ‡∏ô `listings` collection
- ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö `products` ‡πÅ‡∏•‡∏∞ `users` ‡πÑ‡∏ß‡πâ

**Confirmation:**
```
‚ö†Ô∏è  Delete ALL documents in "listings" collection? (yes/no):
```
‡∏û‡∏¥‡∏°‡∏û‡πå **yes** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

---

### 4. ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥!)
```bash
npm run cleanup:all
```

**‡∏°‡∏±‡∏ô‡∏à‡∏∞:**
- ‚ùå ‡∏•‡∏ö‡∏ó‡∏∏‡∏Å document ‡πÉ‡∏ô `products` collection
- ‚ùå ‡∏•‡∏ö‡∏ó‡∏∏‡∏Å document ‡πÉ‡∏ô `listings` collection
- ‚úÖ **‡πÄ‡∏Å‡πá‡∏ö `users` collection ‡πÑ‡∏ß‡πâ** (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢!)

**Confirmation:**
```
‚ö†Ô∏è  Are you ABSOLUTELY SURE? Type "DELETE ALL" to confirm:
```
‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà‡∏ß‡πà‡∏≤ **DELETE ALL** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

---

## ‚ö†Ô∏è **‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç**

### üî¥ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö:
- ‚ùå **‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®** ‡πÉ‡∏ô products
- ‚ùå **‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®** ‡πÉ‡∏ô listings
- ‚ùå **‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ!**

### üü¢ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö:
- ‚úÖ **Users** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà
- ‚úÖ **Authentication** - login ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥
- ‚úÖ **Collections ‡∏≠‡∏∑‡πà‡∏ô‡πÜ** - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ

---

## üìù **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà**

### Step 1: Cleanup
```bash
# ‡πÄ‡∏ä‡πá‡∏Ñ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
npm run cleanup:count

# ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
npm run cleanup:all
# ‡∏û‡∏¥‡∏°‡∏û‡πå: DELETE ALL

# ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
npm run cleanup:count
```

**Expected Output:**
```
  Products:  0 documents  ‚úÖ
  Listings:  0 documents  ‚úÖ
  Users:     5 documents  ‚úÖ
```

---

### Step 2: Test Listing System
1. ‡πÄ‡∏õ‡∏¥‡∏î http://localhost:3000
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà "‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®" (`/sell`)
3. ‡∏•‡∏≠‡∏á‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏´‡∏°‡πà 1-2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤:
   - ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
   - ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - ‚úÖ ‡∏°‡∏µ AI features
   - ‚úÖ ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

---

### Step 3: Verify
```bash
npm run cleanup:count
```

**Should show:**
```
  Products:  0 documents  ‚úÖ (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß)
  Listings:  2 documents  ‚úÖ (‡∏•‡∏á‡πÉ‡∏´‡∏°‡πà)
  Users:     5 documents  ‚úÖ (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
```

---

## üéâ **‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Cleanup**

### ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà:
1. **‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®:** ‡πÉ‡∏ä‡πâ `/sell` ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
2. **Data:** ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `listings` collection
3. **Format:** Unified Listing System
4. **Features:** AI ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å features

### ‚úÖ Code ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:
- `src/app/sell/page.tsx` - ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®
- `src/lib/listings/` - Listing utilities
- `src/services/unifiedMarketplace.ts` - Unified service

### ‚ùå Code ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß:
- `src/app/product/` - ‡∏•‡∏ö‡πÑ‡∏î‡πâ (legacy)
- ~~products collection~~ - ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß

---

## üöÄ **Migration Plan (Future)**

‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï:

1. **Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤**
   ```bash
   firebase export
   ```

2. **Cleanup**
   ```bash
   npm run cleanup:all
   ```

3. **Import ‡πÉ‡∏´‡∏°‡πà** ‡∏ú‡πà‡∏≤‡∏ô script
   - ‡πÅ‡∏õ‡∏•‡∏á products ‚Üí listings
   - Validate ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° AI features

---

## üìä **Script Details**

### Cleanup Script Location:
```
scripts/cleanup-old-data.ts
```

### How it works:
1. Connect to Firestore via Admin SDK
2. Ask for confirmation
3. Delete in batches (500 docs at a time)
4. Show progress
5. Return total count

### Safety Features:
- ‚úÖ Requires explicit confirmation
- ‚úÖ For "all" mode: must type "DELETE ALL"
- ‚úÖ Shows count before/after
- ‚úÖ Batch delete (prevents timeout)
- ‚úÖ Never touches `users` collection

---

## ‚ùì **FAQ**

### Q: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• users ‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏´‡∏°?
**A:** ‡πÑ‡∏°‡πà! Script ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏∞ `users` collection ‡πÄ‡∏•‡∏¢

### Q: ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°?
**A:** ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ! ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏õ‡πá‡∏ô permanent

### Q: ‡∏Ñ‡∏ß‡∏£‡∏•‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà?
**A:** 
- ‚úÖ ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ - ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô dev/testing
- ‚ùå ‡∏´‡πâ‡∏≤‡∏° - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á users ‡πÅ‡∏•‡πâ‡∏ß

### Q: ‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ß‡πá‡∏ö‡∏û‡∏±‡∏á‡πÑ‡∏´‡∏°?
**A:** ‡πÑ‡∏°‡πà‡∏û‡∏±‡∏á! ‡πÄ‡∏ß‡πá‡∏ö‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ ‡πÅ‡∏Ñ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

### Q: ‡∏ï‡πâ‡∏≠‡∏á re-deploy ‡πÑ‡∏´‡∏°?
**A:** ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á! ‡πÅ‡∏Ñ‡πà‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô database

---

## üéØ **Ready to Clean?**

```bash
# ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
npm run cleanup:count

# ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥!)
npm run cleanup:all

# ‡∏û‡∏¥‡∏°‡∏û‡πå: DELETE ALL
```

**‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà!** üöÄ

---

**Last Updated:** 2025-12-28 22:30 ICT  
**Status:** ‚úÖ Ready to use
